<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ArtMera - Generator MÄƒrÈ›iÈ™or Digital</title>
    <style>
        :root { --wood: #e8d4b9; --wood-dark: #5d4037; --red: #d32f2f; }
        body { font-family: 'Georgia', serif; background: #f4f1ea; display: flex; justify-content: center; padding: 20px; }
        .container { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); max-width: 650px; width: 100%; border: 1px solid #ddd; text-align: center; }
        .lang-picker { margin-bottom: 20px; }
        .lang-btn { padding: 8px 18px; cursor: pointer; border: 1px solid var(--wood-dark); background: none; border-radius: 6px; margin: 0 5px; transition: 0.3s; }
        .lang-btn.active { background: var(--wood-dark); color: white; }
        .section { margin-bottom: 20px; text-align: left; }
        label { display: block; font-weight: bold; margin-bottom: 8px; color: var(--wood-dark); }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; font-size: 1rem; }
        textarea { height: 80px; resize: none; }
        .btn-gen { background: var(--red); color: white; border: none; width: 100%; padding: 18px; font-weight: bold; cursor: pointer; border-radius: 8px; font-size: 1.1rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        #canvas-container { margin-top: 25px; }
        canvas { max-width: 100%; height: auto; border: 10px solid white; box-shadow: 0 8px 25px rgba(0,0,0,0.15); border-radius: 4px; display: none; }
        .btn-down { background: #4caf50; color: white; border: none; padding: 12px 25px; margin-top: 15px; cursor: pointer; border-radius: 6px; display: none; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <div class="lang-picker">
        <button class="lang-btn active" onclick="setLang('ro')">RomÃ¢nÄƒ</button>
        <button class="lang-btn" onclick="setLang('en')">English</button>
        <button class="lang-btn" onclick="setLang('es')">EspaÃ±ol</button>
    </div>

    <div class="section">
        <label id="l-photo">ÃŽncarcÄƒ poza ta (Upload Your Photo):</label>
        <input type="file" id="photoInput" accept="image/*">
    </div>

    <div class="section">
        <label id="l-msg">Mesaj de primÄƒvarÄƒ:</label>
        <select id="msgSelect" onchange="document.getElementById('customMsg').value = this.value">
        </select>
        <textarea id="customMsg" style="margin-top:10px;"></textarea>
    </div>

    <button class="btn-gen" id="btn-gen" onclick="draw()">GENEREAZÄ‚ MÄ‚RÈšIÈ˜OR</button>

    <div id="canvas-container">
        <canvas id="c" width="800" height="800"></canvas>
        <br>
        <button class="btn-down" id="btn-down" onclick="download()">DESCARCÄ‚ MÄ‚RÈšIÈ˜ORUL</button>
    </div>
</div>

<script>
const data = {
    ro: { photo: "ÃŽncarcÄƒ poza ta:", msg: "Alege mesajul:", btn: "GENEREAZÄ‚ MÄ‚RÈšIÈ˜OR", down: "DESCARCÄ‚ MÄ‚RÈšIÈ˜ORUL", msgs: ["O primÄƒvarÄƒ plinÄƒ de bucurii!", "SÄƒ-È›i fie sufletul plin de luminÄƒ!", "Un gÃ¢nd bun de MÄƒrÈ›iÈ™or!"] },
    en: { photo: "Upload your photo:", msg: "Choose message:", btn: "GENERATE MÄ‚RÈšIÈ˜OR", down: "DOWNLOAD MÄ‚RÈšIÈ˜OR", msgs: ["Happy Spring filled with joy!", "May your spirit bloom bright!", "A MÄƒrÈ›iÈ™or with a warm wish!"] },
    es: { photo: "Sube tu foto:", msg: "Elige mensaje:", btn: "GENERAR MÄ‚RÈšIÈ˜OR", down: "DESCARGAR MÄ‚RÈšIÈ˜OR", msgs: ["Â¡Feliz primavera!", "Â¡Que tu alma florezca!", "Â¡Un MÄƒrÈ›iÈ™or con cariÃ±o!"] }
};

let currentLang = 'ro';
function setLang(l) {
    currentLang = l;
    document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
    event.target.classList.add('active');
    document.getElementById('l-photo').innerText = data[l].photo;
    document.getElementById('l-msg').innerText = data[l].msg;
    document.getElementById('btn-gen').innerText = data[l].btn;
    document.getElementById('btn-down').innerText = data[l].down;
    const s = document.getElementById('msgSelect'); s.innerHTML = '';
    data[l].msgs.forEach(m => { let o = document.createElement('option'); o.value = m; o.text = m; s.add(o); });
    document.getElementById('customMsg').value = data[l].msgs[0];
}
setLang('ro');

function draw() {
    const canvas = document.getElementById('c');
    const ctx = canvas.getContext('2d');
    const file = document.getElementById('photoInput').files[0];
    if (!file) { alert("Te rugÄƒm sÄƒ Ã®ncarci o pozÄƒ!"); return; }

    const reader = new FileReader();
    reader.onload = function(e) {
        const img = new Image();
        img.onload = function() {
            // 1. Fundal Lemn Tei Gravat
            ctx.fillStyle = "#e8d4b9";
            ctx.fillRect(0, 0, 800, 800);
            
            // Fibrele lemnului
            ctx.strokeStyle = "rgba(139, 69, 19, 0.08)";
            ctx.lineWidth = 1;
            for(let i=0; i<800; i+=3) {
                ctx.beginPath(); ctx.moveTo(0, i); ctx.lineTo(800, i + (Math.random()*10 - 5)); ctx.stroke();
            }

            // 2. GravurÄƒ adÃ¢ncÄƒ: Flori de mÄƒr (Sus) È™i Hornari (Lateral)
            ctx.shadowColor = "rgba(0,0,0,0.4)"; ctx.shadowBlur = 3; ctx.shadowOffsetX = 1; ctx.shadowOffsetY = 2;
            ctx.fillStyle = "rgba(93, 64, 55, 0.7)";
            ctx.font = "bold 25px Arial"; ctx.textAlign = "center";
            ctx.fillText("âœ¿ âœ¿ âœ¿ âœ¿ âœ¿ âœ¿ âœ¿ âœ¿ âœ¿ âœ¿ âœ¿ âœ¿ âœ¿ âœ¿ âœ¿ âœ¿ âœ¿ âœ¿", 400, 50);
            
            // Hornari gravati (Simbol scara si perie)
            ctx.font = "60px Serif";
            ctx.fillText("ðŸªœðŸ§¹", 120, 420); 
            ctx.fillText("ðŸ§¹ðŸªœ", 680, 420);

            // 3. Ghiocei plantaÈ›i Ã®n pÄƒmÃ¢nt (Jos)
            ctx.shadowBlur = 0; ctx.shadowOffsetX = 0; ctx.shadowOffsetY = 0;
            for(let j=0; j<9; j++) {
                let x = 80 + (j*80);
                // Tulpina
                ctx.strokeStyle = "#4a7c44"; ctx.lineWidth = 3;
                ctx.beginPath(); ctx.moveTo(x, 780); ctx.quadraticCurveTo(x-15, 720, x, 680); ctx.stroke();
                // Floarea
                ctx.fillStyle = "white"; ctx.beginPath(); ctx.arc(x, 680, 10, 0, Math.PI*2); ctx.fill();
                ctx.strokeStyle = "#ccc"; ctx.lineWidth = 1; ctx.stroke();
            }

            // 4. Poza Ã®n cercul MÄƒrÈ›iÈ™or
            ctx.save();
            ctx.beginPath(); ctx.arc(400, 380, 200, 0, Math.PI*2); ctx.clip();
            ctx.drawImage(img, 200, 180, 400, 400);
            ctx.restore();

            // Bordura cercului (Fir Alb-RoÈ™u)
            ctx.lineWidth = 18;
            ctx.setLineDash([25, 25]);
            ctx.strokeStyle = "#d32f2f"; ctx.beginPath(); ctx.arc(400, 380, 209, 0, Math.PI*2); ctx.stroke();
            ctx.strokeStyle = "white"; ctx.lineDashOffset = 25; ctx.beginPath(); ctx.arc(400, 380, 209, 0, Math.PI*2); ctx.stroke();
            ctx.setLineDash([]);

            // 5. FundiÈ›a MÄƒrÈ›iÈ™or (lÃ¢ngÄƒ cerc)
            const fx = 180, fy = 200;
            ctx.strokeStyle = "#d32f2f"; ctx.lineWidth = 6;
            ctx.beginPath(); ctx.arc(fx, fy, 25, 0, Math.PI*2); ctx.stroke(); // bucla stanga
            ctx.beginPath(); ctx.arc(fx+50, fy, 25, 0, Math.PI*2); ctx.stroke(); // bucla dreapta
            ctx.strokeStyle = "white"; ctx.setLineDash([5, 5]);
            ctx.beginPath(); ctx.arc(fx, fy, 25, 0, Math.PI*2); ctx.stroke();
            ctx.beginPath(); ctx.arc(fx+50, fy, 25, 0, Math.PI*2); ctx.stroke();
            ctx.setLineDash([]);

            // 6. Mesaj gravat
            ctx.shadowColor = "rgba(0,0,0,0.2)"; ctx.shadowBlur = 2; ctx.shadowOffsetX = 1; ctx.shadowOffsetY = 1;
            ctx.fillStyle = "#5d4037"; ctx.font = "italic bold 32px 'Georgia'"; ctx.textAlign = "center";
            ctx.fillText(document.getElementById('customMsg').value, 400, 640);

            canvas.style.display = 'inline-block';
            document.getElementById('btn-down').style.display = 'inline-block';
        }
        img.src = e.target.result;
    }
    reader.readAsDataURL(file);
}

function download() {
    const link = document.createElement('a');
    link.download = 'martisor-artmera.png';
    link.href = document.getElementById('c').toDataURL();
    link.click();
}
</script>

</body>
</html>
