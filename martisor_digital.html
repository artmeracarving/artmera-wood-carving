<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ArtMera - Generator Mărțișor Digital</title>
    <style>
        :root { --wood: #d2b48c; --wood-dark: #5d4037; --red: #d32f2f; }
        body { font-family: sans-serif; background: #f4f1ea; display: flex; justify-content: center; padding: 20px; }
        .container { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); max-width: 600px; width: 100%; border: 1px solid #ddd; }
        .lang-picker { text-align: center; margin-bottom: 20px; }
        .lang-btn { padding: 5px 15px; cursor: pointer; border: 1px solid var(--wood-dark); background: none; border-radius: 4px; }
        .lang-btn.active { background: var(--wood-dark); color: white; }
        .section { margin-bottom: 15px; }
        label { display: block; font-weight: bold; margin-bottom: 5px; }
        input, select, textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        .btn-gen { background: var(--red); color: white; border: none; width: 100%; padding: 15px; font-weight: bold; cursor: pointer; border-radius: 4px; margin-top: 10px; }
        #canvas-container { margin-top: 20px; text-align: center; position: relative; }
        canvas { max-width: 100%; height: auto; border: 5px solid white; box-shadow: 0 0 10px rgba(0,0,0,0.2); border-radius: 4px; display: none; }
        .btn-down { background: #4caf50; color: white; border: none; padding: 10px 20px; margin-top: 10px; cursor: pointer; border-radius: 4px; display: none; }
    </style>
</head>
<body>

<div class="container">
    <div class="lang-picker" id="langPicker">
        <button class="lang-btn active" onclick="setLang('ro')">RO</button>
        <button class="lang-btn" onclick="setLang('en')">EN</button>
        <button class="lang-btn" onclick="setLang('es')">ES</button>
    </div>

    <div class="section">
        <label id="l-photo">Încarcă poza (portret):</label>
        <input type="file" id="photoInput" accept="image/*">
    </div>

    <div class="section">
        <label id="l-msg">Mesaj de primăvară:</label>
        <select id="msgSelect" onchange="document.getElementById('customMsg').value = this.value">
        </select>
        <textarea id="customMsg" style="margin-top:10px;"></textarea>
    </div>

    <button class="btn-gen" id="btn-gen" onclick="draw()">GENEREAZĂ MĂRȚIȘOR</button>

    <div id="canvas-container">
        <canvas id="c" width="800" height="800"></canvas>
        <button class="btn-down" id="btn-down" onclick="download()">Descarcă Imaginea</button>
    </div>
</div>

<script>
const data = {
    ro: { photo: "Încarcă poza:", msg: "Alege mesajul:", btn: "GENEREAZĂ MĂRȚIȘOR", down: "Descarcă", msgs: ["O primăvară plină de bucurii!", "Să-ți fie sufletul plin de lumină!", "Un gând bun de Mărțișor!"] },
    en: { photo: "Upload photo:", msg: "Choose message:", btn: "GENERATE MĂRȚIȘOR", down: "Download", msgs: ["Happy Spring filled with joy!", "May your spirit bloom bright!", "A Mărțișor with a warm wish!"] },
    es: { photo: "Sube tu foto:", msg: "Elige mensaje:", btn: "GENERAR MĂRȚIȘOR", down: "Descargar", msgs: ["¡Feliz primavera!", "¡Que tu alma florezca!", "¡Un Mărțișor con cariño!"] }
};

let currentLang = 'ro';
function setLang(l) {
    currentLang = l;
    document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
    event.target.classList.add('active');
    document.getElementById('l-photo').innerText = data[l].photo;
    document.getElementById('l-msg').innerText = data[l].msg;
    document.getElementById('btn-gen').innerText = data[l].btn;
    document.getElementById('btn-down').innerText = data[l].down;
    const s = document.getElementById('msgSelect'); s.innerHTML = '';
    data[l].msgs.forEach(m => { let o = document.createElement('option'); o.value = m; o.text = m; s.add(o); });
    document.getElementById('customMsg').value = data[l].msgs[0];
}
setLang('ro');

function draw() {
    const canvas = document.getElementById('c');
    const ctx = canvas.getContext('2d');
    const file = document.getElementById('photoInput').files[0];
    if (!file) { alert("Te rugăm să încarci o poză!"); return; }

    const reader = new FileReader();
    reader.onload = function(e) {
        const img = new Image();
        img.onload = function() {
            // 1. Fundal Lemn Tei
            ctx.fillStyle = "#e8d4b9";
            ctx.fillRect(0, 0, 800, 800);
            for(let i=0; i<800; i+=2) { // Fibrele lemnului
                ctx.strokeStyle = "rgba(139, 69, 19, 0.05)";
                ctx.beginPath(); ctx.moveTo(0, i); ctx.lineTo(800, i + Math.random()*5); ctx.stroke();
            }

            // 2. Gravură Hornari & Flori Măr (Simulat prin Shadow)
            ctx.shadowColor = "rgba(0,0,0,0.3)"; ctx.shadowBlur = 2; ctx.shadowOffsetX = 1; ctx.shadowOffsetY = 1;
            ctx.strokeStyle = "#8b4513"; ctx.lineWidth = 2;
            
            // Flori măr sus
            ctx.strokeText("✿ ✿ ✿ ✿ ✿ ✿ ✿ ✿ ✿", 250, 60);
            
            // Hornari (stânga/dreapta)
            ctx.font = "40px Arial";
            ctx.strokeText("⚒", 100, 400); // Simbol hornar stilizat
            ctx.strokeText("⚒", 700, 400);

            // 3. Ghiocei în pământ (jos)
            ctx.shadowBlur = 0; ctx.shadowOffsetX = 0; ctx.shadowOffsetY = 0;
            for(let j=0; j<8; j++) {
                let x = 100 + (j*85);
                ctx.strokeStyle = "green"; ctx.beginPath(); ctx.moveTo(x, 750); ctx.quadraticCurveTo(x-10, 700, x, 650); ctx.stroke();
                ctx.fillStyle = "white"; ctx.beginPath(); ctx.arc(x, 650, 8, 0, Math.PI*2); ctx.fill(); ctx.stroke();
            }

            // 4. Poza Utilizator în Cercul Alb-Roșu
            ctx.save();
            ctx.beginPath(); ctx.arc(400, 350, 200, 0, Math.PI*2); ctx.clip();
            ctx.drawImage(img, 200, 150, 400, 400);
            ctx.restore();

            // Bordura Mărțișor (Alb-Roșu)
            ctx.lineWidth = 15;
            ctx.setLineDash([20, 20]);
            ctx.strokeStyle = "#d32f2f"; ctx.beginPath(); ctx.arc(400, 350, 205, 0, Math.PI*2); ctx.stroke();
            ctx.strokeStyle = "white"; ctx.lineDashOffset = 20; ctx.beginPath(); ctx.arc(400, 350, 205, 0, Math.PI*2); ctx.stroke();
            ctx.setLineDash([]);

            // 5. Fundița Mărțișor (lângă cerc)
            ctx.strokeStyle = "#d32f2f"; ctx.lineWidth = 5;
            ctx.beginPath(); ctx.arc(210, 200, 20, 0, Math.PI*2); ctx.stroke(); // bucla 1
            ctx.beginPath(); ctx.arc(170, 200, 20, 0, Math.PI*2); ctx.stroke(); // bucla 2

            // 6. Mesaj
            ctx.fillStyle = "#5d4037"; ctx.font = "italic 30px Georgia"; ctx.textAlign = "center";
            ctx.fillText(document.getElementById('customMsg').value, 400, 600);

            canvas.style.display = 'inline-block';
            document.getElementById('btn-down').style.display = 'inline-block';
        }
        img.src = e.target.result;
    }
    reader.readAsDataURL(file);
}

function download() {
    const link = document.createElement('a');
    link.download = 'martisor-artmera.png';
    link.href = document.getElementById('c').toDataURL();
    link.click();
}
</script>
</body>
</html>
